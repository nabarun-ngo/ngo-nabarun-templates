name: Sync
on:
  workflow_call:
    inputs:
      sync_auth0:
        required: true
        type: boolean
      sync_firebaseRC:
        required: true
        type: boolean
      firebase_source_project:
        required: false
        type: string
      firebase_target_project:
        required: false
        type: string
      branch_name:
        required: false
        type: string
        default : 'main'
      
    secrets:
      auth0_source_config:
        required: false
      auth0_dest_config:
        required: false
      firebase_service_account_source:
        required: false
      firebase_service_account_target:
        required: false
        
jobs:

  sync_data:
    name: 'Sync Data'
    runs-on: ubuntu-latest
    steps:
      - name: Sync Auth0 Tenants
        if: ${{ inputs.sync_auth0 }}
        uses: ./.github/actions/sync-auth0-v2
        with:
          branch_name: ${{ inputs.branch_name }}
          source_config: ${{ secrets.auth0_source_config }}
          dest_config: ${{ secrets.auth0_dest_config }}

      - name: Sync Firebase Remote Config
        if: ${{ inputs.sync_firebaseRC }}
        uses: ./.github/actions/sync-firebase-v2
        with:
          branch_name: ${{ inputs.branch_name }}
          firebase_source_project: ${{ inputs.firebase_source_project }}
          firebase_target_project: ${{ inputs.firebase_target_project }}
          firebase_service_account_source: ${{ secrets.firebase_service_account_source }}
          firebase_service_account_target: ${{ secrets.firebase_service_account_target }}

      
    
